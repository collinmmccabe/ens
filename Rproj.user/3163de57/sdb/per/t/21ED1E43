{
    "collab_server" : "",
    "contents" : "#----------------#\n#   Predicting   #\n#  EGS from Emp  #\n#----------------#\n\nEffective_el_emp <- readRDS(\"./sims_empirical/Effective_el_emp_w\")\nEffective_spp_emp <- readRDS(\"./sims_empirical/Effective_spp_emp_w\")\nEffective_SI_emp <- readRDS(\"./sims_empirical/Effective_SI_emp_w\")\n\nSI_emp_output <- data.frame(n.exp=efgrsz.SI(mean(Effective_SI_emp[[1]][1,which(Effective_SI_emp[[1]][2,]==0)])), n.obs=Effective_el_emp[[1]][1,4])\nfor(i in 2:length(Effective_SI_emp)) {\n  tmp <- data.frame(n.exp=efgrsz.SI(mean(Effective_SI_emp[[i]][1,which(Effective_SI_emp[[i]][2,]==0)])), n.obs=Effective_el_emp[[i]][1,4])\n  SI_emp_output <- rbind(SI_emp_output, tmp)\n}\n\nEGS_emp <- cbind(Effective_spp_emp, n_obs=SI_emp_output[,2], n_exp_si=SI_emp_output[,1])\n\nEGS_emp[which(EGS_emp[,4]<81),]\n\n#------------------------------------------------\n\nEffective_SIR_emp <- readRDS(\"./sims_empirical/Effective_SIR_emp_w\")\n\nSIR_emp_output <- data.frame(n.exp=efgrsz.SIR(mean(Effective_SIR_emp[[1]][1,which(Effective_SIR_emp[[1]][4,]==Effective_el_emp[[1]][1,4])])), n.obs=Effective_el_emp[[1]][1,4])\nfor(i in 2:length(Effective_SI_emp)) {\n  tmp <- data.frame(n.exp=efgrsz.SIR(mean(Effective_SIR_emp[[i]][1,which(Effective_SIR_emp[[i]][4,]==Effective_el_emp[[i]][1,4])])), n.obs=Effective_el_emp[[i]][1,4])\n  SIR_emp_output <- rbind(SIR_emp_output, tmp)\n}\n\nEGS_emp <- cbind(Effective_spp_emp, n_obs=SI_emp_output[,2], n_exp_si=SI_emp_output[,1], n_exp_sir=SIR_emp_output[,1])\nwrite.csv(x = EGS_emp[which(EGS_emp[,4]<81),], file = \"EGS_emp.csv\")\n\n\n\n#----------------------#\n#  Testing Usefulness  #\n#   of EGS for Group   #\n#   Size PGLS Assocs   #\n#----------------------#\n\niterations = 1000\n\npldata <- read.csv(\"./data_files/pglsdata5.csv\", header = T)\ncolnames(pldata)[1] <- \"spp\"\npltree<-read.nexus(\"./data_files/consensusTree_10kTrees_Primates_Version3.nex\")\npltree<-makeLabel(pltree)\n\npltree2<-drop.tip(pltree,setdiff(pltree$tip.label,pldata$spp))\n\ntiff(\"Figure6.tiff\", height = 10, width = 8.5, units = 'cm', compression = \"lzw\", res = 300)\n\npar(mar=c(0, 0, 0, 0), ps=10)\nplot(pltree2)\n\ndev.off()\n\n# p_total_resid <- scale(residuals.pgls(pgls(log(p_total+1) ~ log(cit_wos+1), data = primate, lambda='ML')))[,1]\n# p_close_resid <- scale(residuals.pgls(pgls(log(p_close+1) ~ log(cit_wos+1), data = primate, lambda='ML')))[,1]\n# p_nonclose_resid <- scale(residuals.pgls(pgls(log(p_nonclose+1) ~ log(cit_wos+1), data = primate, lambda='ML')))[,1]\n# p_helm_resid <- scale(residuals.pgls(pgls(log(p_helm+1) ~ log(cit_wos+1), data = primate, lambda='ML')))[,1]\n# p_virus_resid <- scale(residuals.pgls(pgls(log(p_virus+1) ~ log(cit_wos+1), data = primate, lambda='ML')))[,1]\n# p_prot_resid <- scale(residuals.pgls(pgls(log(p_prot+1) ~ log(cit_wos+1), data = primate, lambda='ML')))[,1]\n\n# zresids <- cbind(p_total_resid, p_close_resid, p_nonclose_resid, p_helm_resid, p_virus_resid, p_prot_resid)\n# write.csv(zresids, \"zresids.csv\")\n\n\n# pldata$n_exp_sir <- scale(log(pldata$n_exp_sir))\n# pldata$n_exp_si <- scale(log(pldata$n_exp_si))\npldata$n_exp_sir <- scale(log(pldata$old_exp_sir))\npldata$n_exp_si <- scale(log(pldata$old_exp_si))\npldata$n_obs <- scale(log(pldata$n_obs))\npldata$range_km2 <- scale(log(pldata$range_km2))\npldata$mass_g <- scale(log(pldata$mass_g))\n\nrow.names(pldata) <- pldata$spp\n\nprimate <- comparative.data(phy = pltree, data = pldata, names.col = spp, vcv = TRUE)\nsummary(obs1<-pgls(scale(log(p_total)) ~ n_obs +scale(log(cit_wos)), data = primate, lambda='ML'))\n\nprimate2 <- comparative.data(phy = pltree, data = pldata[which(pldata$p_close > 0),], names.col = spp, vcv = TRUE)\nsummary(obs2<-pgls(scale(log(p_close)) ~ n_obs +scale(log(cit_wos)), data = primate2, lambda='ML'))\n\nprimate3 <- comparative.data(phy = pltree, data = pldata[which(pldata$p_helm > 0),], names.col = spp, vcv = TRUE)\nsummary(obs3<-pgls(scale(log(p_helm)) ~ n_obs +scale(log(cit_wos)), data = primate3, lambda='ML'))\n\nprimate4 <- comparative.data(phy = pltree, data = pldata[which(pldata$p_prot > 0),], names.col = spp, vcv = TRUE)\nsummary(obs4<-pgls(scale(log(p_prot)) ~ n_obs +scale(log(cit_wos)), data = primate4, lambda='ML'))\n\nprimate5 <- comparative.data(phy = pltree, data = pldata[which(pldata$p_virus > 0),], names.col = spp, vcv = TRUE)\nsummary(obs5<-pgls(scale(log(p_virus)) ~ n_obs +scale(log(cit_wos)), data = primate5, lambda='ML'))\n\nsummary(exp_si1<-pgls(scale(log(p_total)) ~ n_exp_si +scale(log(cit_wos)), data = primate, lambda='ML'))\nsummary(exp_si2<-pgls(scale(log(p_close)) ~ n_exp_si +scale(log(cit_wos)), data = primate2, lambda='ML'))\nsummary(exp_si3<-pgls(scale(log(p_helm)) ~ n_exp_si +scale(log(cit_wos)), data = primate3, lambda='ML'))\nsummary(exp_si4<-pgls(scale(log(p_prot)) ~ n_exp_si +scale(log(cit_wos)), data = primate4, lambda='ML'))\nsummary(exp_si5<-pgls(scale(log(p_virus)) ~ n_exp_si +scale(log(cit_wos)), data = primate5, lambda='ML'))\n\nsummary(exp_sir1<-pgls(scale(log(p_total)) ~ n_exp_sir +scale(log(cit_wos)), data = primate, lambda='ML'))\nsummary(exp_sir2<-pgls(scale(log(p_close)) ~ n_exp_sir +scale(log(cit_wos)), data = primate2, lambda='ML'))\nsummary(exp_sir3<-pgls(scale(log(p_helm)) ~ n_exp_sir +scale(log(cit_wos)), data = primate3, lambda='ML'))\nsummary(exp_sir4<-pgls(scale(log(p_prot)) ~ n_exp_sir +scale(log(cit_wos)), data = primate4, lambda='ML'))\nsummary(exp_sir5<-pgls(scale(log(p_virus)) ~ n_exp_sir +scale(log(cit_wos)), data = primate5, lambda='ML'))\n\nsummary(range_km21<-pgls(scale(log(p_total)) ~ range_km2 +scale(log(cit_wos)), data = primate, lambda='ML'))\nsummary(range_km22<-pgls(scale(log(p_close)) ~ range_km2 +scale(log(cit_wos)), data = primate2, lambda='ML'))\nsummary(range_km23<-pgls(scale(log(p_helm)) ~ range_km2 +scale(log(cit_wos)), data = primate3, lambda='ML'))\nsummary(range_km24<-pgls(scale(log(p_prot)) ~ range_km2 +scale(log(cit_wos)), data = primate4, lambda='ML'))\nsummary(range_km25<-pgls(scale(log(p_virus)) ~ range_km2 +scale(log(cit_wos)), data = primate5, lambda='ML'))\n\nsummary(mass_g1<-pgls(scale(log(p_total)) ~ mass_g +scale(log(cit_wos)), data = primate, lambda='ML'))\nsummary(mass_g2<-pgls(scale(log(p_close)) ~ mass_g +scale(log(cit_wos)), data = primate2, lambda='ML'))\nsummary(mass_g3<-pgls(scale(log(p_helm)) ~ mass_g +scale(log(cit_wos)), data = primate3, lambda='ML'))\nsummary(mass_g4<-pgls(scale(log(p_prot)) ~ mass_g +scale(log(cit_wos)), data = primate4, lambda='ML'))\nsummary(mass_g5<-pgls(scale(log(p_virus)) ~ mass_g +scale(log(cit_wos)), data = primate5, lambda='ML'))\n\nAICc(exp_si1, exp_sir1, obs1, range_km21, mass_g1)\nAICc(exp_si2, exp_sir2, obs2, range_km22, mass_g2)\nAICc(exp_si3, exp_sir3, obs3, range_km23, mass_g3)\nAICc(exp_si4, exp_sir4, obs4, range_km24, mass_g4)\nAICc(exp_si5, exp_sir5, obs5, range_km25, mass_g5)\n\n\n# write(c(\"iteration\",\"beta_totsi\",\"p_totsi\",\"R2_totsi\",\"adR2_totsi\",\"l_totsi\",\"beta_totsir\",\"p_totsir\",\"R2_totsir\",\"adR2_totsir\",\"l_totsir\",\"beta_closi\",\"p_closi\",\"R2_closi\",\"adR2_closi\",\"l_closi\",\"beta_closi\",\"p_totsi\",\"R2_totsi\",\"adR2_totsi\",\"l_totsi\",\"beta_totsi\",\"p_totsi\",\"R2_totsi\",\"adR2_totsi\",\"l_totsi\",\"beta_totsi\",\"p_totsi\",\"R2_totsi\",\"adR2_totsi\",\"l_totsi\",\"beta_totsi\",\"p_totsi\",\"R2_totsi\",\"adR2_totsi\",\"l_totsi\",\"beta_totsi\",\"p_totsi\",\"R2_totsi\",\"adR2_totsi\",\"l_totsi\",\"beta_totsi\",\"p_totsi\",\"R2_totsi\",\"adR2_totsi\",\"l_totsi\",\"beta_totsi\",\"p_totsi\",\"R2_totsi\",\"adR2_totsi\",\"l_totsi\",\"beta_totsi\",\"p_totsi\",\"R2_totsi\",\"adR2_totsi\",\"l_totsi\",\"beta_totsi\",\"p_totsi\",\"R2_totsi\",\"adR2_totsi\",\"l_totsi\"), append=FALSE)\n#\n# for (i in 1:iterations)\n# {\n#   subd_data <- ddply(pldata, .(spp), function(x) {x[sample(nrow(x), 1),]})\n#\n#   row.names(subd_data) <- subd_data$spp\n#\n#   primate <- comparative.data(phy = pltree, data = pldata, names.col = spp, vcv = TRUE)\n#\n#   virus_sir <- pgls(p_virus_resid ~ n_exp_sir, data = primate, lambda='ML')\n#\n#   write(c(i,summary(total_si)$coefficients[2,1],summary(total_si)$coefficients[2,2],summary(model.pgls)$coefficients[2,3],summary(model.pgls)$coefficients[2,4],summary(model.pgls)$r.squared,summary(model.pgls)$adj.r.squared,summary(model.pgls)$param[2]), \"output/animals_output-centralization.txt\", ncolumns=8, append=TRUE, sep=\"\\t\")\n# }\n",
    "created" : 1495132268890.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "530038447",
    "id" : "21ED1E43",
    "lastKnownWriteTime" : 1492533968,
    "last_content_update" : 1492533968,
    "path" : "D:/Dropbox/Research/Effective Network Modeling/Effective_Network_Size/code/PGLS.R",
    "project_path" : "code/PGLS.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}